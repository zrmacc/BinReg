---
title: "Probit Regression"
author: "Zachary McCaw"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Probit Regression}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r global_options, include=FALSE}
knitr::opts_chunk$set(fig.width=2*3, fig.height=1.5*2, fig.align="center", fig.path='Figs/',echo=T, warning=F, message=F, cache=F, results='hold');
set.seed(201);
library(Probit);
```

## Contents

* [Probit Model](#probit-model)
* [Robit Model](#robit-model)

# Probit

## Model

Suppose $y_{i}\in\{0,1\}$ is a binary outcome, and $z_{i}\in\mathbb{R}^{p}$ is a set of covariates. Let $\eta_{i} = z_{i}'\beta$ denote the linear predictor. Consider the hierarchical model:

$$
\zeta_{i}|z_{i} \sim N\big(\eta_{i},1) \\
y_{i} = I[\zeta_{i}>0]
$$

## Implementation

```{r}
# Subjects
n = 1e3;
# Design matrix
Z = matrix(rnorm(n=n*3),nrow=n);
# Regression coefficient
beta = c(1,-1,1);
# Linear predictor
eta = Z %*% beta;
# Probit outcome
y = 1*(rnorm(n=n,mean=eta)>0);
# Recover regression parameters
M = fit.Probit(y=y,Z=Z);
show(M);
```

# Robit

## Model

Suppose $y_{i}\in\{0,1\}$ is a binary outcome, and $z_{i}\in\mathbb{R}^{p}$ is a set of covariates. Let $\eta_{i} = z_{i}'\beta$ denote the linear predictor. Consider the hierarchical model:

$$
\zeta_{i}|z_{i} \sim t_{\nu}(\eta_{i}) \\
y_{i} = I[\zeta_{i}>0]
$$

## Implementation

```{r}
# Degrees of freedom
df = 7;
# Robit outcome
y = 1*(rt(n=n,ncp=eta,df=df)>0);
# Recover regression parameters
M = fit.Robit(y=y,Z=Z);
show(M);
```